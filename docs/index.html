<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>Grid</h1>
<p>Take a 2d array returned from range.getValues(), and iterate over them. Each row produces a json where headers are keys. Each row can have calculated properties based on values of that row.</p>
<h2>Getting Started</h2>
<ul>
<li>Install via Library ID <code>1aF6ka72qAVEfcYoyvftvTWOxih8wcCPo6TUcxgXTjCnwezIhZS6Fmla5</code></li>
<li>Check out <a href="https://classroomtechtools.github.io/Grid/">documentation</a></li>
<li>Use it for reading in and auto parsing spreadsheet ranges, so that you can just iterate over them and do whatever</li>
</ul>
<p>Two features of this library are that it takes the 2d array you send it, and as you go through the <code>for/of</code> (in V8) loop, it produces a row object:</p>
<pre class="prettyprint source lang-js"><code>const values = [ [&quot;one&quot;, &quot;two&quot;], [1, 2] ];
const grid = Grid.create(values);
for (const row of grid) {
  Logger.log(row.headers);  // [&quot;one&quot;, &quot;two&quot;]
  Logger.log(row.values);  // [1, 2]
  Logger.log(row.json);  // {one: 1, two: 2}
  Logger.log(row.idx);  // 1
}
</code></pre>
<p>And you can iterate over the cells in each row:</p>
<pre class="prettyprint source lang-js"><code>for (const row of grid) {
  for (const cell of row) {
    Logger.log(cell.header);
    Logger.log(cell.value);
    Logger.log(cell.idx);
  }
}
</code></pre>
<p>Destructuring is nice:</p>
<pre class="prettyprint source lang-js"><code>const values = [ [&quot;one&quot;, &quot;two&quot;], [1, 2] ];
const grid = Grid.create(values);
for (const {json} of grid) {
  for (const {one} of json) {
    Logger.log(one);  // outputs 1, then 2
  }
}
</code></pre>
<p>Many applications with rows in spreadsheets often need to have calculated values, sorta like <strong>phantom columns</strong>, whose values are derived from native values in the data range.</p>
<p>For example, if you have a <code>firstName</code> header and a <code>lastName</code> header, and you want to calculate a <code>fullName</code> header, just calculate it by passing the constructor an object whose keys are the name of the header, and its values are functions.</p>
<pre class="prettyprint source lang-js"><code>const values = [ [&quot;firstName&quot;, &quot;lastName&quot;], [&quot;S&quot;, &quot;Holmes&quot;] ];
const grid = Grid.create(values, {
  fullName (json) {
    const {firstName, lastName} = json;
    return `${firstName} ${lastName}`;
  },
  serial (json, row) {
    // pad so there are two characters
    return row.idx.toString().padStart(2, '0');
  },

});

for (const {json} of grid) {
  Logger.log(json);  
  // {serial: '01', fullName: &quot;S Holmes&quot;, ...}
}
</code></pre>
<p>If you want to re-define the names of your headers, you can do that after initialization (rows objects are created as they are interated over):</p>
<pre class="prettyprint source lang-js"><code>const grid = Grid.create([[&quot;one&quot;, &quot;two&quot;], [1, 2]]);
grid.headers = [&quot;ONE&quot;, &quot;TWO&quot;];
for (const {json} of grid) {
  Logger.log(json);  // {ONE: 1, TWO: 2}
}
</code></pre>
<h2>TODO</h2>
<p>Calculated values column-wide (such as for indexing).</p>
<h2>Motivation</h2>
<p>Taking a 2d array of spreadsheet values is a pretty common thing, might as well make a nice iterator for it.</p></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Cell.html">Cell</a></li><li><a href="Grid.html">Grid</a></li><li><a href="Row.html">Row</a></li></ul><h3>Global</h3><ul><li><a href="global.html#create">create</a></li><li><a href="global.html#fromNamedValues">fromNamedValues</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Thu Jul 15 2021 19:30:50 GMT+0800 (Malaysia Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>